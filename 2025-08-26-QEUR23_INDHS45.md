---
title: QEUR23_INDHS45 - 閑話休題～ヴェーダ数秘術をやってみる(併用法NO6-main_program)   
date: 2025-08-26
tags: ["QEUシステム", "メトリックス", "Python言語", "Unsloth", "LLM", "データセット", "BONSAI", "LangGraph"]
excerpt: あたらしいLLMの学習体系を確立する
---

## QEUR23_INDHS45 - 閑話休題～ヴェーダ数秘術をやってみる(併用法NO6-main_program)    

## ～  終わった。課題はあるがね・・・ ～

D先生： “やっと、この長い閑話休題もラストにきました。前回も同じセリフをいましたが、本当に終わりでいいんですよね？“

**(大人物:B)**

![imageINDS2-45-1](/2025-08-26-QEUR23_INDHS45/imageINDS2-45-1.jpg)

QEU:FOUNDER ： “いいですよ。もう、サクサクと終わらせましょう。プログラムをドン！！”

```python
# ---
# -*- coding: utf-8 -*-
import json
import logging
import os
from datetime import datetime
from typing import Dict, List, Tuple, Any
import matplotlib.pyplot as plt
import numpy as np
import re

# 日本語フォント対応
try:
    from japanize_matplotlib import japanize
    japanize()
except ImportError:
    logging.warning("japanize_matplotlibがインストールされていません。日本語フォントが正しく表示されない可能性があります。")

# LLM対応
try:
    from openai import OpenAI
    OPENAI_AVAILABLE = True
except ImportError:
    logging.warning("openaiライブラリがインストールされていません。LLM解釈は利用できません。")
    OPENAI_AVAILABLE = False

# C, Dプログラムのインポート
try:
    from numerology_fortune_calculator import calculate_and_generate_results as calc_numerology_graph
    NUMEROLOGY_CALC_AVAILABLE = True
    logging.info("numerology_fortune_calculator モジュールを正常にインポートしました。")
except ImportError as e:
    NUMEROLOGY_CALC_AVAILABLE = False
    logging.error(f"numerology_fortune_calculator モジュールのインポートに失敗しました: {e}")

try:
    from nakshatra_fortune_calculator import calculate_and_generate_graph as calc_nakshatra_graph
    NAKSHATRA_CALC_AVAILABLE = True
    logging.info("nakshatra_fortune_calculator モジュールを正常にインポートしました。")
except ImportError as e:
    NAKSHATRA_CALC_AVAILABLE = False
    logging.error(f"nakshatra_fortune_calculator モジュールのインポートに失敗しました: {e}")

# ロギング設定
logging.basicConfig(level=logging.INFO,
                    format='%(asctime)s - %(levelname)s - %(message)s',
                    handlers=[logging.StreamHandler()])
logger = logging.getLogger(__name__)

# fortune_data.jsonの読み込み
def load_fortune_data():
    try:
        with open("fortune_data.json", "r", encoding="utf-8") as f:
            return json.load(f)
    except Exception as e:
        logger.error(f"fortune_data.json読み込みエラー: {e}")
        return {
            "category_names": {
                "money": "お金", "health": "健康", "relation": "人間関係",
                "business": "事業", "growth": "成長", "family": "家族", "competition": "競争"
            },
            "colors": {
                "money": "#e377c2", "health": "#ff7f0e", "relation": "#1f77b4",
                "business": "#2ca02c", "growth": "#d62728", "family": "#9467bd", "competition": "#8c564b"
            },
            "markers": {
                "money": "*", "health": "s", "relation": "o",
                "business": "^", "growth": "D", "family": "v", "competition": "p"
            },
            "categories_info": {}
        }

# その他のJSONファイル読み込み
def load_json_data():
    try:
        with open("career_data.json", "r", encoding="utf-8") as f:
            career_data = json.load(f)
        with open("personality_data.json", "r", encoding="utf-8") as f:
            personality_data = json.load(f)
        return career_data, personality_data
    except Exception as e:
        logger.error(f"JSONデータ読み込みエラー: {e}")
        return {}, {}

# 新しい運勢比較表（金運・健康運のみ、5年ごと）
def generate_validation_table(state: Dict[str, Any], birth_year: int, end_year: int) -> str:
    fortune_data = load_fortune_data()
    category_names = fortune_data.get("category_names", {})
    markdown = "### 運勢計算妥当性確認表（金運・健康運）\n\n"
    markdown += "| 年 | 数秘術:金運 | 占星術:金運 | 総合:金運 | 数秘術:健康運 | 占星術:健康運 | 総合:健康運 |\n"
    markdown += "|----|------------|------------|------------|------------|------------|------------|\n"

    numerology_scores = state.get('c_state', {}).get('fortune_trend_advanced', {})
    nakshatra_scores = state.get('d_state', {}).get('scores_11point', {})
    combined_scores = state.get('combined_fortune_scores', {})

    money_n = numerology_scores.get("money", [])
    health_n = numerology_scores.get("health", [])
    money_d = nakshatra_scores.get("money", [])
    health_d = nakshatra_scores.get("health", [])

    for year in range(birth_year, end_year + 1, 5):
        n_money = next((s for y, s in money_n if y == year), 0)
        n_health = next((s for y, s in health_n if y == year), 0)
        d_money = next((s for y, s in money_d if y == year), 0.0)
        d_health = next((s for y, s in health_d if y == year), 0.0)
        c_money = combined_scores.get(str(year), {}).get("money", 0)
        c_health = combined_scores.get(str(year), {}).get("health", 0)

        markdown += f"| {year} | {n_money} | {d_money:.1f} | {c_money} | {n_health} | {d_health:.1f} | {c_health} |\n"
    
    return markdown + "\n"

# LLMレスポンスからスコア抽出
def extract_scores_from_llm_response(response: str, keys: List[str]) -> Dict[str, int]:
    scores = {}
    logger.info(f"LLMレスポンスからスコア抽出を開始: {response[:500]}...")
    for key in keys:
        pattern = rf"{key}\s*:\s*(\d)/5"
        match = re.search(pattern, response, re.IGNORECASE)
        if match:
            try:
                score = int(match.group(1))
                if 1 <= score <= 5:
                    scores[key] = score
                else:
                    logger.warning(f"キー {key} のスコア {score} が範囲外です。")
            except ValueError:
                logger.warning(f"キー {key} のスコア変換に失敗しました。")
        else:
            logger.warning(f"キー {key} のスコアが見つかりませんでした。")
    return scores

class MainProgramAnalyzer:
    def generate_fortune_trend_graph(self, fortune_trend: Dict[str, List[Tuple[int, float]]],
                                     filename: str, full_name: str, birth_year: int, end_year: int) -> str:
        logger.info(f"運勢トレンドグラフを生成: {filename}")
        fortune_data = load_fortune_data()
        category_names = fortune_data.get("category_names", {})
        colors = fortune_data.get("colors", {})
        markers = fortune_data.get("markers", {})
        offsets = {k: v.get("offset", 0.0) for k, v in fortune_data.get("categories_info", {}).items()}
        
        plt.figure(figsize=(16, 10))
        categories = ["money", "health", "relation", "business", "growth", "family", "competition"]
        legend_handles = []
        
        for category in categories:
            if category in fortune_trend and fortune_trend[category]:
                years, scores = zip(*fortune_trend[category])
                offset = offsets.get(category, 0.0)
                adjusted_scores = [s + offset for s in scores]
                handle, = plt.plot(years, adjusted_scores,
                                   color=colors.get(category, '#000000'),
                                   marker=markers.get(category, 'o'),
                                   linestyle='-', linewidth=2, markersize=6)
                legend_handles.append(handle)
        
        plt.title(f'{full_name} 総合運勢トレンド ({birth_year}年 - {end_year}年)', fontsize=14)
        plt.xlabel('年', fontsize=12)
        plt.ylabel('運勢スコア (-5:大凶 ～ +5:大吉)', fontsize=12)
        plt.ylim(-5.5, 5.5)
        plt.grid(True, linestyle='--', alpha=0.7)
        plt.legend(handles=legend_handles, 
                   labels=[category_names.get(cat, cat) for cat in categories if cat in fortune_trend],
                   loc='upper right', fontsize='x-small')
        plt.xticks(range(birth_year, end_year + 1, 5))
        plt.tight_layout()
        plt.savefig(filename, dpi=300)
        plt.close()
        return filename

    def generate_report(self, state: Dict[str, Any]) -> str:
        fortune_data = load_fortune_data()
        category_names = fortune_data.get("category_names", {})
        
        report = f"=== 総合運勢レポート ===\n"
        report += f"【基本情報】\n"
        report += f"- フルネーム: {state['full_name']}\n"
        report += f"- 生年月日: {state['birth_datetime'].strftime('%Y年%m月%d日')}\n"
        report += f"- 出生時刻: {state['birth_datetime'].strftime('%H:%M')}\n"
        report += f"- 出生地: {state.get('birth_location', '不明')}\n"
        report += f"- 対象終了年: {state['end_year']}\n"
        report += f"- LLM解釈年: {state['llm_comment_year']}\n"

        # 数秘術情報
        report += f"【数秘術情報】\n"
        report += f"- ディスティニーナンバー: {state['c_state'].get('destiny_number', '不明')}\n"
        report += f"- ソウルナンバー: {state['c_state'].get('soul_number', '不明')}\n"
        report += f"- パーソナリティナンバー: {state['c_state'].get('personality_number', '不明')}\n"
        report += f"- ライフパスナンバー: {state['c_state'].get('birth_number', '不明')}\n"
        report += f"- パーソナルイヤーナンバー ({state['llm_comment_year']}年): {state['c_state'].get('llm_fortune_trend_py', '不明')}\n"

        # 占星術情報
        report += f"【インド占星術情報】\n"
        report += f"- ナクシャトラ: {state['d_state'].get('current_dasha', {}).get('nakshatra', '不明')}\n"
        report += f"- パダ: {state['d_state'].get('current_dasha', {}).get('pada', '不明')}\n"
        report += f"- ダシャー ({state['llm_comment_year']}年): {state['d_state'].get('llm_fortune_dasha', {}).get('birth_dasha', '不明')}\n"

        # 運勢妥当性確認表
        report += generate_validation_table(state, state['birth_datetime'].year, state['end_year'])

        # 統合運勢スコア
        if state['combined_fortune_scores']:
            year_for_scores = state['llm_comment_year']
            if str(year_for_scores) in state['combined_fortune_scores']:
                scores = state['combined_fortune_scores'][str(year_for_scores)]
                report += f"【{year_for_scores}年の統合運勢スコア】\n"
                for key, score in scores.items():
                    display_name = category_names.get(key, key)
                    report += f"- {display_name}: {score}/5\n"
            else:
                report += f"【{year_for_scores}年の統合運勢スコア】\n該当年のスコアが見つかりません。\n"
        else:
            report += "【統合運勢スコア】データがありません。\n"

        # キャリアと人格スコア
        career_data, personality_data = load_json_data()
        career_names = career_data.get("career_names", {})
        trait_names = personality_data.get("trait_names", {})
        report += generate_markdown_table("キャリアスコア", state.get("career_scores", {}), ca-reer_names)
        report += generate_markdown_table("人格・能力スコア", state.get("personality_scores", {}), trait_names)

        report += f"【LLMによる専門解釈】\n{state.get('llm_interpretation', 'LLM解釈が生成されませんでした。')}\n"
        return report

    def _call_llm(self, prompt: str) -> str:
        if not OPENAI_AVAILABLE:
            return "LLMが利用できません。openaiライブラリをインストールしてください。"
        DEEPSEEK_API_KEY = os.getenv('DEEPSEEK_API_KEY')
        if not DEEPSEEK_API_KEY:
            return "APIキーが設定されていません。環境変数 DEEPSEEK_API_KEY を設定してください。"
        try:
            client = OpenAI(api_key=DEEPSEEK_API_KEY, base_url="https://api.deepseek.com")
            response = client.chat.completions.create(
                model="deepseek-chat",
                messages=[
                    {"role": "system", "content": "あなたは正統ヴェーダ数秘術と正統インド占星術の専門家です。提供された項目について、明確に「キー名: スコア/5」の形式でスコアを返し、文化的背景を尊重した詳細な解釈を提供してください。"},
                    {"role": "user", "content": prompt}
                ],
                temperature=0.7,
                max_tokens=1500
            )
            return response.choices[0].message.content
        except Exception as e:
            logger.error(f"LLM呼び出しエラー: {str(e)}")
            return f"LLM解釈生成エラー: {str(e)}"

def main_program(full_name: str, birth_datetime: datetime, birth_location: str,
                 end_year: int, llm_comment_year: int) -> Dict[str, Any]:
    logger.info("メインプログラム処理を開始します。")
    state = {
        'full_name': full_name,
        'birth_datetime': birth_datetime,
        'birth_location': birth_location,
        'end_year': end_year,
        'llm_comment_year': llm_comment_year,
        'errors': [],
        'c_state': {},
        'd_state': {},
        'combined_fortune_scores': {},
        'career_scores': {},
        'personality_scores': {},
        'llm_interpretation': '',
        'combined_graph': ''
    }

    fortune_data = load_fortune_data()
    category_names = fortune_data.get("category_names", {})
    analyzer = MainProgramAnalyzer()

    # Cプログラム呼び出し
    try:
        if not NUMEROLOGY_CALC_AVAILABLE:
            raise RuntimeError("numerology_fortune_calculator モジュールが利用できません。")
        c_state = calc_numerology_graph(
            full_name=full_name,
            birth_datetime=birth_datetime,
            end_year=end_year,
            llm_comment_year=llm_comment_year,
            birth_location=birth_location
        )
        state['c_state'] = c_state
    except Exception as e:
        state['errors'].append(f"Cプログラム呼び出しエラー: {str(e)}")
        logger.error(f"Cプログラム呼び出しエラー: {str(e)}")

    # Dプログラム呼び出し
    try:
        if not NAKSHATRA_CALC_AVAILABLE:
            raise RuntimeError("nakshatra_fortune_calculator モジュールが利用できません。")
        d_state = calc_nakshatra_graph(
            full_name=full_name,
            birth_datetime=birth_datetime,
            birth_location=birth_location,
            end_year=end_year,
            llm_comment_year=llm_comment_year,
        )
        state['d_state'] = d_state
    except Exception as e:
        state['errors'].append(f"Dプログラム呼び出しエラー: {str(e)}")
        logger.error(f"Dプログラム呼び出しエラー: {str(e)}")

    # 統合スコア計算（scores_11point を使用）
    try:
        numerology_scores = state['c_state'].get('fortune_trend_advanced', {})
        nakshatra_scores = state['d_state'].get('scores_11point', {})
        combined_fortune_scores = {}
        combined_fortune_trend = {}
        Coeff_D = 1.0
        categories = ["money", "health", "relation", "business", "growth", "family", "competition"]

        for year in range(birth_datetime.year, end_year + 1, 5):
            year_scores = {}
            for category in categories:
                c_score = next((s for y, s in numerology_scores.get(category, []) if y == year), 0)
                d_score_float = next((s for y, s in nakshatra_scores.get(category, []) if y == year), 0.0)
                d_score = int(round(d_score_float))
                interaction = 1 if c_score > 2 and d_score > 2 else -1 if c_score < -2 and d_score < -2 else 0
                combined_score = d_score + Coeff_D * interaction
                year_scores[category] = max(-5, min(5, int(round(combined_score))))
            if year_scores:
                combined_fortune_scores[str(year)] = year_scores

        for category in categories:
            trend_data = []
            for year in range(birth_datetime.year, end_year + 1, 5):
                score = combined_fortune_scores.get(str(year), {}).get(category, 0)
                trend_data.append((year, score))
            if trend_data:
                combined_fortune_trend[category] = trend_data
        state['combined_fortune_scores'] = combined_fortune_scores
        state['combined_fortune_trend'] = combined_fortune_trend
    except Exception as e:
        state['errors'].append(f"統合スコア計算エラー: {str(e)}")
        logger.error(f"統合スコア計算エラー: {str(e)}")

    # 総合グラフ生成
    try:
        combined_fortune_trend = state.get('combined_fortune_trend', {})
        if combined_fortune_trend:
            name_slug = re.sub(r'[^a-zA-Z0-9\u3040-\u309F\u30A0-\u30FF\s]', '', full_name).strip().replace(' ', '_')
            combined_graph_filename = f"{name_slug}_combined_fortune_trend.png"
            state['combined_graph'] = analyzer.generate_fortune_trend_graph(
                combined_fortune_trend, combined_graph_filename, full_name, birth_datetime.year, end_year
            )
    except Exception as e:
        state['errors'].append(f"統合グラフ生成エラー: {str(e)}")
        state['combined_graph'] = '統合グラフ生成失敗'
        logger.error(f"統合グラフ生成エラー: {str(e)}")

    # LLM解釈生成
    try:
        c_report = state['c_state'].get('report', 'Cプログラムレポートなし')
        d_report = state['d_state'].get('report', 'Dプログラムレポートなし')
        combined_scores = state['combined_fortune_scores'].get(str(llm_comment_year), {})
        combined_scores_str = "\n".join([f"- {category_names.get(k, k)}: {v}/5" for k, v in com-bined_scores.items()]) if combined_scores else "データなし"

        numerology_numbers = {
            'destiny': state['c_state'].get('destiny_number', '不明'),
            'soul': state['c_state'].get('soul_number', '不明'),
            'personality': state['c_state'].get('personality_number', '不明'),
            'life_path': state['c_state'].get('birth_number', '不明'),
            'personal_year': state['c_state'].get('llm_fortune_trend_py', '不明')
        }

        fortune_data = load_fortune_data()
        categories_info = fortune_data.get("categories_info", {})
        numerology_advanced_scores = state['c_state'].get('llm_fortune_trend_advanced', {})
        numerology_advanced_scores_str = "\n".join([f"- {category_names.get(k, k)}: {v}/5" for k, v in numerology_advanced_scores.items()]) if numerology_advanced_scores else "データなし"
        nakshatra_trend_scores = state['d_state'].get('llm_fortune_trend', {})
        nakshatra_trend_scores_str = "\n".join([f"- {category_names.get(k, k)}: {v:.1f}/5.5" for k, v in nakshatra_trend_scores.items()]) if nakshatra_trend_scores else "データなし"
        dasha_info = state['d_state'].get('llm_fortune_dasha', {})
        dasha_name = dasha_info.get('birth_dasha', '不明')

        career_data, personality_data = load_json_data()
        career_keys = list(career_data.get("career_names", {}).keys())
        personality_keys = list(personality_data.get("trait_names", {}).keys())

        numerology_descriptions = ""
        for num_type, num_value in numerology_numbers.items():
            if num_value != '不明':
                numerology_descriptions += f"- {num_type.capitalize()}ナンバー ({num_value}): このナンバーは個人の{num_type}に関連し、運勢や性格に影響を与えます。\n"

        prompt = f"""
以下の情報を基に、{full_name} 様の{llm_comment_year}年の運勢を、正統なヴェーダ数秘術とインド占星術の観点から、親しみやすく、具体的なアドバイスを含めて解釈してください。文化的背景を尊重し、カルマとダルマの観点も考慮してください。

【基本情報】
- 生年月日: {birth_datetime.strftime('%Y年%m月%d日')}
- 出生時間: {birth_datetime.strftime('%H:%M')}
- 出生地: {birth_location}

【ヴェーダ数秘術の情報】
{numerology_descriptions}
- 高精度運勢スコア ({llm_comment_year}年):
{numerology_advanced_scores_str}

【インド占星術の情報】
- ナクシャトラ: {state['d_state'].get('current_dasha', {}).get('nakshatra', '不明')}
- パダ: {state['d_state'].get('current_dasha', {}).get('pada', '不明')}
- ダシャー ({llm_comment_year}年): {dasha_name}
- 運勢スコア ({llm_comment_year}年):
{nakshatra_trend_scores_str}

【カテゴリ情報】
{json.dumps(categories_info, ensure_ascii=False, indent=2)}

【就業特性】
以下の各項目について、1～5のスコアを「- キー名: スコア/5」の形式で明示してください。
{', '.join(career_keys)}

【人格能力】
以下の各項目について、1～5のスコアを「- キー名: スコア/5」の形式で明示してください。
{', '.join(personality_keys)}

【{llm_comment_year}年の総合運勢】
- 統合運勢スコア:
{combined_scores_str}
- カルマとダルマに基づく運勢の総合評価コメントを含めてください。

【アドバイス】
- 運気アップのための具体的なアドバイスを提供してください（例：瞑想、特定の行動、色の活用など）。
- インド占星術に基づく惑星の影響やダシャー効果を考慮したアドバイスも含めてください。
- 数秘術ナンバーに基づく具体的な行動指針も提案してください。

【参考情報】
- 数秘術レポート (Cプログラム):
{c_report}
- 占星術レポート (Dプログラム):
{d_report}
"""
        logger.info(f"LLMプロンプト:\n{prompt[:500]}...")
        prompt = prompt.replace(full_name, "ユーザー様")
        llm_response = analyzer._call_llm(prompt)
        state['llm_interpretation'] = llm_response

        state['career_scores'] = extract_scores_from_llm_response(llm_response, career_keys)
        state['personality_scores'] = extract_scores_from_llm_response(llm_response, personality_keys)

        if not state['career_scores']:
            logger.warning("キャリアスコアが抽出できませんでした。デフォルト値を設定します。")
            state['career_scores'] = {key: 3 for key in career_keys}
        if not state['personality_scores']:
            logger.warning("人格スコアが抽出できませんでした。デフォルト値を設定します。")
            state['personality_scores'] = {key: 3 for key in personality_keys}

    except Exception as e:
        state['errors'].append(f"LLM解釈生成エラー: {str(e)}")
        state['llm_interpretation'] = f"LLM解釈生成エラー: {str(e)}"
        logger.error(f"LLM解釈生成エラー: {str(e)}")

    # 総合レポート生成
    try:
        state['report'] = analyzer.generate_report(state)
    except Exception as e:
        state['errors'].append(f"レポート生成エラー: {str(e)}")
        state['report'] = 'レポート生成失敗'
        logger.error(f"レポート生成エラー: {str(e)}")

    logger.info("メインプログラム処理が完了しました。")
    return state

if __name__ == "__main__":
    full_name = "Steve Jobs"
    birth_datetime = datetime(1955, 2, 24, 19, 0)
    birth_location = "ロサンゼルス"
    end_year = 2012
    llm_comment_year = 2010

    print(f"- 処理開始: {full_name} -")
    result = main_program(full_name, birth_datetime, birth_location, end_year, llm_comment_year)
    print("="*50)
    print("="*50)
    print(result['report'])
    print(f"総合運勢トレンドグラフ: {result['combined_graph']}")

    if result['errors']:
        print("=== エラー ===")
        for error in result['errors']:
            print(f"- {error}")
    print("- 処理完了 -")
    print("="*50)
```

D先生： “いままで、システム化を推進した甲斐があって、ずいぶんプログラムがすっきりしてきました。 “


       (imageINDS2-45-2)
![imageINDS2-45-1](/2025-08-26-QEUR23_INDHS45/imageINDS2-45-1.jpg)


QEU:FOUNDER ： “このmain_programを起動すると、関連したすべてのプログラムが動き出します。その動いている様子が、このスクリーン（↑）から見えるんです。ちょっと、LLMの出力を見てみましょうか。”

### === 総合運勢レポート ===

### 【基本情報】
- フルネーム: 安倍晋三(Abe Shinzo)
- 生年月日: 1954年09月21日
- 出生時刻: 09:00
- 出生地: 東京
- 対象終了年: 2022
- LLM解釈年: 2013

### 【数秘術情報】
- ディスティニーナンバー: 7
- ソウルナンバー: 7
- パーソナリティナンバー: 9
- ライフパスナンバー: 4
- パーソナルイヤーナンバー (2013年): 9

### 【インド占星術情報】
- ナクシャトラ: उत्तरभाद्रपदा (Uttara Bhadrapada: （ラクシャトラNO26-土星）)
- パダ: पद 1 (Pada 1: 1つ目の四分位)
- ダシャー (2013年): बुध (Budh: 水星)

### 運勢計算妥当性確認表（金運・健康運）

| 年 | 数秘術:金運 | 占星術:金運 | 総合:金運 | 数秘術:健康運 | 占星術:健康運 | 総合:健康運 |
|----|------------|------------|------------|------------|------------|------------|
| 1954 | -1 | 3.0 | 3 | 0 | 2.0 | 2 |
| 1959 | 1 | -1.0 | -1 | 1 | -2.0 | -2 |
| 1964 | 1 | -1.0 | -1 | -1 | -2.0 | -2 |
| 1969 | 1 | -1.0 | -1 | -1 | -2.0 | -2 |
| 1974 | -1 | -1.0 | -1 | 2 | -2.0 | -2 |
| 1979 | -1 | -1.0 | -1 | 1 | -2.0 | -2 |
| 1984 | -1 | -1.0 | -1 | -1 | -2.0 | -2 |
| 1989 | 1 | -1.0 | -1 | -1 | -2.0 | -2 |
| 1994 | 1 | 3.0 | 3 | -3 | 2.0 | 2 |
| 1999 | -1 | 3.0 | 3 | 0 | 2.0 | 2 |
| 2004 | 1 | -1.0 | -1 | 1 | -2.0 | -2 |
| 2009 | 1 | -1.0 | -1 | -1 | -2.0 | -2 |
| 2014 | 1 | -1.0 | -1 | -1 | -2.0 | -2 |
| 2019 | -1 | -1.0 | -1 | 2 | -2.0 | -2 |

### キャリアスコア

| 項目 | スコア |
|------|--------|
| 教師・人文系・ライター | 4/5 |
| 科学者・数学者・エンジニア | 5/5 |
| 宗教家・哲学者 | 5/5 |
| オフィスワーカー・マネージャー | 3/5 |
| シェフ・アーティスト | 3/5 |
| エンターテイナー・ミュージシャン | 2/5 |
| 経営者・CEO | 4/5 |
| 政治家・高層公務員 | 3/5 |

### 人格・能力スコア

| 項目 | スコア |
|------|--------|
| リーダーシップ | 4/5 |
| 体力 | 2/5 |
| 芸術センス | 3/5 |
| 精神的強さ | 5/5 |
| 公平さ | 4/5 |
| やさしさ | 3/5 |
| 正直さ | 4/5 |
| 創造性 | 5/5 |
| コミュニケーション | 3/5 |
| 適応力 | 4/5 |

【LLMによる専門解釈】
承知いたしました。ユーザー様の2013年の運勢を、正統ヴェーダ数秘術とインド占星術の観点から詳細に分析いたします。

## 2013年の総合運勢

### カルマとダルマに基づく総合評価
2013年はユーザー様にとって大きな変革と浄化の年でした。Destinyナンバー7とSoulナンバー7（両方ラーフ支配）が示すように、この年は過去のカルマの清算と新しい精神的気づきの時期でした。Life Pathナンバー4（土星支配）の実用的な性質とPersonal Yearナンバー9（火星支配）の完結のエネルギーが組み合わさり、人生の一つの章が閉じられる重要な年でした。

インド占星術では水星ダシャー中であり、水星はコミュニケーションと知性を司りますが、ナクシャトラがUttara Bhadrapada（土星支配）であるため、慎重さと忍耐が求められる年でした。物質面での困難（金運1/5、事業1/5）は、より深い精神的成長への道を開くための試練として捉えるべきです。

### アドバイス

### 数秘術に基づくアドバイス
- **Destinyナンバー7**：瞑想と内省を深め、直感を信じてください。青や灰色の服装が落ち着きをもたらします。
- **Personal Yearナンバー9**：この年は完結と解放の時期です。過去に執着せず、新しいサイクルへの準備を整えましょう。
- **Life Pathナンバー4**：規則正しい生活リズムを維持し、現実的な目標設定を心がけてください。

### インド占星術に基づくアドバイス
- **水星ダシャー中**：知識とコミュニケーションを重視し、緑色のものを身に着けると良いでしょう。
- **Uttara Bhadrapadaナクシャトラ**：忍耐強く物事に対処し、急な決定は避けましょう。土曜日には慈善活動を行うことで土星の影響を和らげられます。

### 総合的な運気向上法
1. 毎朝15分の瞑想を行い、内面の平静を保つ
2. アメジストの宝石を身に着けてラーフのエネルギーを調整
3. 水曜日と土曜日に断食または軽食で過ごす
4. 青色と緑色を生活に取り入れる（服装、インテリアなど）
5. 知識を得るための読書や学習を積極的に行う

2013年は表面的な困難に見えても、深いレベルでの精神的成長とカルマの浄化が進んでいた年でした。この経験は後の人生において貴重な智慧となって現れるでしょう。

D先生： “はあ？**「正直さが4/5」であり、「創造性が5/5」なの？**まあ、LLMは、当たり障りのないことを言っています。それにしても就業適性なんかは、紫微斗数の場合とは、かなり違いますね。”

QEU:FOUNDER： “Vibe Codingでお手軽に作ったシステムです。そんな些細な欠陥があることは、しようがないですよ。所詮、当たらぬも八卦のシステムです。これから運勢グラフを見てみましょう。



    (imageINDS2-45-3)
![imageINDS2-45-1](/2025-08-26-QEUR23_INDHS45/imageINDS2-45-1.jpg)


D先生： “せっかく2つの情報を併合したのに、ナクシュトラ単体と、運勢グラフの変動がほとんど変わらないです。”

```python
##### **4.3 プログラムE: 総合運勢スコア計算**
- **目的**: C（ヴェーダ数秘術）とD（インド占星術）の運勢スコアを統合。
- **入力**:
  - `numerology_scores`（Cから）、`nakshatra_scores`（Dから）。
- **出力**:
  - `Dict[str, float]`（カテゴリごとの統合スコア、-5～+5）。
- **計算ロジック**:
  1. 各カテゴリ（金運、健康運など）に対して、CとDのスコアを取得。
  2. 相互作用項 `interaction` を計算：
     - `interaction = +1` if Cスコア > 2 かつ Dスコア > 2
     - `interaction = -1` if Cスコア < -2 かつ Dスコア < -2
     - それ以外は `interaction = 0`
  3. 係数 Coeff_D を用いて統合スコアを計算：
     - `combined_score = nakshatra_score + Coeff_D * interaction`
  4. 結果を小数点以下を四捨五入して整数化し、-5から+5の範囲にクランプ。
  5. `llm_comment_year`年の統合スコアを保存。

```

QEU:FOUNDER ： “交互作用(interaction)を使って修正していますからね。あえて、もっとも変動しない設計にしているんですよ。しかし、根本問題は、ナクシャトラ運勢の変動自体がおかしいんです。他のケースを見てみましょう。”

    (imageINDS2-45-4)
![imageINDS2-45-1](/2025-08-26-QEUR23_INDHS45/imageINDS2-45-1.jpg)

D先生：“それにしても、どれ人物の場合でも似たような動きになります。”

      (imageINDS2-45-5)
![imageINDS2-45-1](/2025-08-26-QEUR23_INDHS45/imageINDS2-45-1.jpg)

QEU:FOUNDER ： “どの人物も人間関係に問題を抱えています。政治家なのに・・・（笑）。いや、政治家だからか・・・。”

D先生：“運勢計算のパラメータの設定に失敗したのですね。もう一度、AIを使った学習（パラメタの最適化）をやってみればどうですか？”



     (imageINDS2-45-6)
![imageINDS2-45-1](/2025-08-26-QEUR23_INDHS45/imageINDS2-45-1.jpg)


QEU:FOUNDER ： “ご期待に応えて、もう一度やってみた（↑）のだが、やっぱりうまいパラメタが作られていないですね。”

D先生：“これが今後の課題です。”


## ～ まとめ ～

D先生：“占い関連の閑話休題が終わりました。今後の課題を残しました。そもそも、この閑話休題で何をしたかったんでしたっけ？我々は？”

- A: 記述統計学（平均、標準偏差）
- B: 基本統計学（回帰分析など：紙と鉛筆でできる）
- C: 応用統計学（random forestなど：コンピュータが必要）
- D: 基本ヒューリスティック（ディープラーニングによる回帰、分類）
- E: 応用ヒューリスティック（トランスフォーマー以降）

QEU:FOUNDER ： “**占いは、本質的には「統計」です**。AIというスゴイ（当てはめ）システムが出来ているのだから、紫微斗数とか西洋占星術みたいなレガシーな手法による差異は必要がないのではないかと思います。完全にヒューリスティックでいいんじゃないですか？”

C部長：“ただし、むりやり（運勢を）当てはめた結果を教えても、教えてもらった人間は納得しませんね。”

QEU:FOUNDER ： “ですから**従来の占いの体裁を、ある程度保ちつつ、ヒューリスティックを導入する**必要があるんです。そこらへんに、「将来につながる面白いテーマ」があるんでしょうね。”

[![MOVIE1](http://img.youtube.com/vi/HESnb9aNhQI/0.jpg)](http://www.youtube.com/watch?v=HESnb9aNhQI "【下手すれば“文明崩壊”の危険】生成AIの源流を築いた伝説的な数理工学者・甘利俊一／人工知能が「心、個性、信念、正義感」を持つように／AIの未来は恐怖と希望が50:50【CROSS DIG 1on1】")

D先生：“今のようなパラメータの設計ではなく、ディープラーニングのシステムに変換し、勾配降下法で計算すると楽ですね。”


    (imageINDS2-45-7)
![imageINDS2-45-1](/2025-08-26-QEUR23_INDHS45/imageINDS2-45-1.jpg)

QEU:FOUNDER ： “そうそう・・・。ユーザーの納得性を重視するのだったら、一度、強引に当てはめたディープラーニングのモデルを作ってから、今のパラメータの値に分解すると説明が楽になるし、予測精度が高くなるんです。”

C部長：“BONSAIはやりますか？”



     (imageINDS2-45-8)
![imageINDS2-45-1](/2025-08-26-QEUR23_INDHS45/imageINDS2-45-1.jpg)


QEU:FOUNDER ： “もともと、AIを使って「（タグチメソッドのいうところの）パラメータ設計」を使った製品の最適化は、**ラーメンの最適化の件**で終わったんです。Vibe Codingも確立しているし、BONSAI程度のシステムは、いつでも簡単にできますよ。”


        (imageINDS2-45-9)
![imageINDS2-45-1](/2025-08-26-QEUR23_INDHS45/imageINDS2-45-1.jpg)

C部長：“ちょうど、あのプロジェクトを始めたことは、世の中にはタブーが多かったです。”

QEU:FOUNDER ： “だから、**AIに言わせていた**んです。AIは、当たり前のことを言いますからね。”

C部長：“次にやることは？”



        (imageINDS2-45-10)
![imageINDS2-45-1](/2025-08-26-QEUR23_INDHS45/imageINDS2-45-1.jpg)

QEU:FOUNDER ： “今までやってきたことを、現在の最新の技術を使って、もう一度やってみる。相当に、パフォーマンスが変わると思うよ。あの頃は、例えばトランスフォーマに**「残り物のTMツール（↑）」**を使えば、「若干だが従来法よりも有利な結果」になっていたものが、もういらなくなっている可能性が十分あります。”

C部長：“基本、AIのアタマが良くなってきています。”

QEU:FOUNDER ： “シンプルになることは、良いことです。”
